---

title: Helper functions for processing data
keywords: fastai
sidebar: home_sidebar

summary: "Functions for getting, splitting, and labeling data, etc"
---
<!--


#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: dev/04_data_core.ipynb
# instructions: https://docs.fast.ai/gen_doc_main.html

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Not exported since we only use it for examples</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get,-split,-label,-and-show">Get, split, label, and show<a class="anchor-link" href="#Get,-split,-label,-and-show">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For most data source creation we need functions to get a list of items, split them in to train/valid sets, and label them. fastai provides functions to make each of these steps easy (especially when combined with <code>fastai.data.blocks</code>), along with showing data (we'll only define image showing in this section).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get">Get<a class="anchor-link" href="#Get">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we'll look at functions that <em>get</em> a list of items (generally file names).</p>
<p>We'll use <em>tiny MNIST</em> (a subset of MNIST with just two classes, <code>7</code>s and <code>3</code>s) for our examples/tests throughout this page.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[PosixPath(&#39;/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3&#39;),
 PosixPath(&#39;/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/7&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>get_files</code>" class="doc_header"><code>get_files</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Get" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_files</code>(<strong><code>path</code></strong>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>include</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get all the files in <code>path</code> with optional <code>extensions</code>, optionally with <code>recurse</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the most general way to grab a bunch of file names from disk. If you pass <code>extensions</code> (including the <code>.</code>) then returned file names are filtered by that list. Only those files directly in <code>path</code> are included, unless you pass <code>recurse</code>, in which case all child folders are also searched recursively. <code>include</code> is an optional list of directories to limit the search to.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t3</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t7</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t</span>  <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
<span class="n">t</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#709) [/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/9932.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/7189.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/8498.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/8888.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/9004.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/7692.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/7556.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/8762.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/9182.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/7666.png...]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's often useful to be able to create functions with customized behavior. <code>fastai.data</code> generally uses functions named as CamelCase verbs ending in <code>er</code> to create these functions. <a href="/data.core.html#FileGetter"><code>FileGetter</code></a> is a simple example of such a function creator.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>FileGetter</code>" class="doc_header"><code>FileGetter</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Get" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FileGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>include</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/data.core.html#get_files"><code>get_files</code></a> partial function that searches path suffix <code>suf</code> and passes along args</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fpng</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="n">fpng_r</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng_r</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>get_image_files</code>" class="doc_header"><code>get_image_files</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Get" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_image_files</code>(<strong><code>path</code></strong>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>include</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get image files in <code>path</code> recursively.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is simply <a href="/data.core.html#get_files"><code>get_files</code></a> called with a list of standard image extensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>ImageGetter</code>" class="doc_header"><code>ImageGetter</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Get" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ImageGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>include</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/data.core.html#get_image_files"><code>get_image_files</code></a> partial function that searches path suffix <code>suf</code> and passes along <code>kwargs</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same as <a href="/data.core.html#FileGetter"><code>FileGetter</code></a>, but for image extensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)),</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">ImageGetter</span><span class="p">(</span>  <span class="s1">&#39;train&#39;</span><span class="p">,</span>                    <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)(</span><span class="n">path</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Split">Split<a class="anchor-link" href="#Split">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next set of functions are used to <em>split</em> data into training and validation sets. The functions return two lists - a list of indices or masks for each of training and validation sets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>RandomSplitter</code>" class="doc_header"><code>RandomSplitter</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Split" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RandomSplitter</code>(<strong><code>valid_pct</code></strong>=<em><code>0.2</code></em>, <strong><code>seed</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Create function that splits <code>items</code> between train/val with <code>valid_pct</code> randomly.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">trn</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">o</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">trn</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
<span class="c1"># test random seed consistency</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trn</span><span class="p">)</span>
<span class="n">trn</span><span class="p">,</span><span class="n">val</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#24) [10,18,16,23,28,26,20,7,21,22...], (#6) [12,0,6,25,8,15])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>GrandparentSplitter</code>" class="doc_header"><code>GrandparentSplitter</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Split" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GrandparentSplitter</code>(<strong><code>train_name</code></strong>=<em><code>'train'</code></em>, <strong><code>valid_name</code></strong>=<em><code>'valid'</code></em>)</p>
</blockquote>
<p>Split <code>items</code> from the grand parent folder names (<code>train_name</code> and <code>valid_name</code>).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/9932.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7189.png&#39;</span><span class="p">,</span> 
         <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7320.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/9833.png&#39;</span><span class="p">,</span>  
         <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/7666.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/925.png&#39;</span><span class="p">,</span>
         <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/724.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/93055.png&#39;</span><span class="p">]</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Label">Label<a class="anchor-link" href="#Label">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final set of functions is used to <em>label</em> a single item of data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>parent_label</code>" class="doc_header"><code>parent_label</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Label" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parent_label</code>(<strong><code>o</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Label <code>item</code> with the parent folder name.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that <a href="/data.core.html#parent_label"><code>parent_label</code></a> doesn't have anything customize, so it doesn't return a function - you can just use it directly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">parent_label</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>RegexLabeller</code>" class="doc_header"><code>RegexLabeller</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Label" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RegexLabeller</code>(<strong><code>pat</code></strong>)</p>
</blockquote>
<p>Label <code>item</code> with regex <code>pat</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/data.core.html#RegexLabeller"><code>RegexLabeller</code></a> is a very flexible function since it handles any regex search of the stringified item. For instance, here's an example the replicates the previous <a href="/data.core.html#parent_label"><code>parent_label</code></a> results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">RegexLabeller</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/(\d)/&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Show">Show<a class="anchor-link" href="#Show">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>show_image</code>" class="doc_header"><code>show_image</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Show" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_image</code>(<strong><code>im</code></strong>, <strong><code>ax</code></strong>=<em><code>None</code></em>, <strong><code>figsize</code></strong>=<em><code>None</code></em>, <strong><code>title</code></strong>=<em><code>None</code></em>, <strong><code>ctx</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Show a PIL image on <code>ax</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/data.core.html#show_image"><code>show_image</code></a> can show b&amp;w images...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">make_cross_image</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">show_image</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIgAAACMCAYAAACnK+FEAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvOIA7rQAAAZBJREFUeJzt3FEKwjAQQEEj3v/K9QLmfbnYyMwBSgmPhZaw67quB+w8f/0C3JtASAIhCYQkEJJASK+h5x717bzW+vozD/x98PEQTBCSQEgCIQmEJBCSQEgCIQmEJBCSQEgCIQmEJBCSQEgCIQmEJBCSQEgCIQmEJBCSQEgCIQmEJBCSQEgCIQmEJBCSQEgCIQmEJBCSQEgCIQmEJBCSQEgCIQmEJBCSQEgCIY3sap/YfX6a085gt1veBCEJhCQQkkBIAiEJhCQQkkBIAiEJhCQQkkBIAiEJhCQQkkBIAiEJhCQQkkBII5eWdxdg72rigvFpZ7BjgpAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIIaf3LTnFmmCAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQnoDeRQUF0fCbgAAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...and color images with standard <code>c*h*w</code> dim order...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im2</span> <span class="o">=</span> <span class="n">make_cross_image</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">show_image</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIgAAACMCAYAAACnK+FEAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvOIA7rQAAAYdJREFUeJzt3MEJAzEMAME4pP+WlQZym5dIDmYKMH4sAoPRmZkHXHn++gL8N4GQBEISCEkgJIGQXhuHnnPu9XbeuO1ZOHPRzHy8sQlCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJIKSVXe33WtROMUFIAiEJhCQQkkBIAiEJhCQQkkBIAiEJhCQQkkBIAiEJhCQQkkBIAiEJhCQQ0sqn5bNxKKuuPpqbICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCOjNXW7rBBOELgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQnoDIYQOFqYYxq4AAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>...and color images with <code>h*w*c</code> dim order...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im3</span> <span class="o">=</span> <span class="n">im2</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">show_image</span><span class="p">(</span><span class="n">im3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIgAAACMCAYAAACnK+FEAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvOIA7rQAAAYdJREFUeJzt3MEJAzEMAME4pP+WlQZym5dIDmYKMH4sAoPRmZkHXHn++gL8N4GQBEISCEkgJIGQXhuHnnPu9XbeuO1ZOHPRzHy8sQlCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJIKSVXe33WtROMUFIAiEJhCQQkkBIAiEJhCQQkkBIAiEJhCQQkkBIAiEJhCQQkkBIAiEJhCQQ0sqn5bNxKKuuPpqbICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCEghJICSBkARCOjNXW7rBBOELgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQhIISSAkgZAEQnoDIYQOFqYYxq4AAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">show_image</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">show_title</span><span class="p">(</span><span class="s2">&quot;Cross&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIgAAACcCAYAAACk/ePfAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvOIA7rQAAA/FJREFUeJzt3LGLHHUYh/HnjUquszAinpCIjWAhNkKUNBJLJTZpFK0sLTQpFEyCWghiEwL6FwS1EFRQhLRBApo/QCGRBONFogY10QjJ+VrMFOG4/Qrh9vbWfT4wxe78dtnZe3bmN3vLVHcjTbJt1i9AW5uBKDIQRQaiyEAUGYgiA1G0kIFU1bNVdbqqrlbVxar6sqr2zPp1bUULF0hVHQCOAm8D9wA7gfeBfeuMvX1zX90W1N0LswB3AleB/RPWvwF8DBwH/gBeBLYzBLUyLkeB7eP4HcDnwG/AZeAksG1c9yrwI3AF+A7YO+vtv5Vl0T4hjwFLwCdhzD5gP/ACQxyvA7uBR4AGPgMOAYeBg8AF4O7xsbuBrqoHgZeAR7t7paruB27b4G3ZFIt2iLkL+KW7b4Qxp7r70+7+p7uvAc8Bb3X3pe7+GXgTeH4cex24F9jV3de7+2QPu49Vhrgeqqo7uvtcd5+d3mZNz6IF8iuw4z/mFj+sub0MnL/p9vnxPoB3gTPAiar6vqpeA+juM8DLDIesS1X1UVUtM4cWLZBTwN/AM2HM2n9vrwC7brq9c7yP7r7S3Qe7+wHgaeBAVe0d133Q3XvGxzbwzsZswuZaqDlId/9eVUeA96rqBnCC4TDxJPAE8Nc6D/sQOFRV3zD8oY8wTGKpqqeAb4GzDJPaVWB1nIPcB3zFEOQ15vXDOOtZ8iwWhnnFaeBP4CfgC+BxhkPC8TVjl4BjwMVxOQYsjeteAc6Nz3MBODze/zDwNcMZzGWGM53lWW/3rSw1bpC0rvnc7WnTGIgiA1FkIIoMRNG0vgeZq1Ojqtrw55zDs8N13wT3IIoMRJGBKDIQRQaiyEAUGYgiA1FkIIoMRJGBKDIQRQaiyEAUGYgiA1FkIIoMRJGBKDIQRQaiyEAUGYgiA1FkIIoMRJGBKDIQRQaiyEAUGYgiA1FkIIoMRJGBKDIQRQaiyEAUGYgiA1FkIIoMRJGBKJrKtdqnce3zeTNv78Gka8u7B1FkIIoMRJGBKDIQRQaiyEAUGYgiA1FkIIoMRJGBKDIQRQaiyEAUGYgiA1FkIIoMRJGBKJrKj5Yn/QB2q5rGD4zn7T2YxD2IIgNRZCCKDESRgSgyEEUGoshAFBmIIgNRZCCKDESRgSgyEEUGoshAFBmIIgNRZCCKDESRgSgyEEUGoshAFBmIIgNRZCCKDESRgSgyEEUGoshAFBmIIgNRZCCKDESRgSgyEEUGoshAFBmIIgNRZCCK6v9yTXFNh3sQRQaiyEAUGYgiA1FkIIoMRJGBKDIQRQaiyEAUGYgiA1FkIIoMRJGBKDIQRQaiyEAUGYgiA1FkIIoMRNG/fYFNCV1f5g0AAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>show_titled_image</code>" class="doc_header"><code>show_titled_image</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Show" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_titled_image</code>(<strong><code>o</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Call <a href="/data.core.html#show_image"><code>show_image</code></a> destructuring <code>o</code> to <code>(img,title)</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>show_image_batch</code>" class="doc_header"><code>show_image_batch</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Show" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>show_image_batch</code>(<strong><code>b</code></strong>, <strong><code>show</code></strong>=<em><code>'show_titled_image'</code></em>, <strong><code>items</code></strong>=<em><code>9</code></em>, <strong><code>cols</code></strong>=<em><code>3</code></em>, <strong><code>figsize</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Display batch <code>b</code> in a grid of size <code>items</code> with <code>cols</code> width</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_image_batch</span><span class="p">(([</span><span class="n">im</span><span class="p">,</span><span class="n">im2</span><span class="p">,</span><span class="n">im3</span><span class="p">],[</span><span class="s1">&#39;bw&#39;</span><span class="p">,</span><span class="s1">&#39;chw&#39;</span><span class="p">,</span><span class="s1">&#39;hwc&#39;</span><span class="p">]),</span> <span class="n">items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhEAAADDCAYAAAA890MfAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvOIA7rQAABwFJREFUeJzt3U+oZnUdx/HP11wUZQsRLHO0yGwTMWT/wMgCwwqKICwiCBe1KgiiNtGiRVFIq2hXEbWQRIigNmYLp0TB/iCWRZjWZExSWYQoEuWvxXMHL5J455P3ebzN67WZc55n7nN+Z+6PH+9z7pmZWWsFAOBMnbPrAQAAR5OIAAAqIgIAqIgIAKAiIgCAiogAACoi4hDNzO9n5updjwP+VzNz3czctutxwEFYe7dHRAAAFREBAFRExOF73cz8amb+PjPfmJnnzsyJmXlvkszMm2Zmzcw79/avnpm7djtkzmYzc2xmvjMzf5mZh2bmK/ve+9LeXP7dzLxj77W3zswv9v2eH87Mnfv2b5uZ92z3LCDHZ+bumfnHzNx4pmvvzHxkZn49Mw/vreGv2dWJPJuJiMP3wSTXJHl5ksuTfCbJiSRv2Xv/zUnuT3LVvv0T2x0ibMzMc5J8P8nJJC9N8pIk3957+w1JfpPkgiTXJ/n6zEySO5JcNjMXzMy5SV6V5OKZOW9mnpfkiiQ/3uqJQPK+JG9P8rIkr05yXQ649s7MtUk+m+RDSV6Y5N1JHtrKqI8YEXH4vrLWemCt9bckn0/ygWwm6v6J+4V9+1dFRLA7r09yUZJPrbUeWWs9ttY6/UDlybXWV9da/07yzSQvTnLhWuuxJD/NZi6/NsndSW5LcmWSNya5d61lAWbbvrzWOrW39n4vyfEcfO39cJLr11o/WRu/XWud3OLYjwwRcfge2Ld9MpsF+o4kl8/MhdlM7G8lOTYzF2SziP9o66OEjWPZxMK//st7D57eWGs9urf5gr1fT1/hnb6auzWbRVkUsysP7tt+NJu5etC191iS+7Y41iNLRBy+Y/u2L0lyam8B/lmSjyf55Vrrn0luT/KJJPettf66/WFCkk30XrL3Y4kz8eSIOH3FJyJ41jiDtfeBbH4EzdMQEYfvozNz8cycn+TTSW7ce/1Eko/liQX21iftwy7cmeRPSb44M8/fexjtygN83e1JXpnN1dyda617klyazXMU7qzxbHKQtfdrST45M1fMxmUzc+l2h3k0iIjDd0OSH2TzAM/9ST639/qJJOfliQX2yfuwdXvPO7wryWVJ/pDkj0nef4CveyTJz5Pcs3d1l2xuHZ9ca/35kIYLjadde9daN2XzDNsNSR5O8t0k5293mEfDrLV2PQYA4AhyJwIAqIgIAKAiIgCAiogAACoiAgConOk/KHMgbzvn2rPmr3zcfGo3/1fWNRcd38lxd+GWx2+abR9zZs6aOZxdnenWv6u7s9Yyhw+TOXzonmoOuxMBAFREBABQEREAQEVEAAAVEQEAVEQEAFAREQBARUQAABURAQBURAQAUBERAEBFRAAAFREBAFREBABQEREAQEVEAAAVEQEAVEQEAFAREQBARUQAABURAQBURAQAUBERAEBFRAAAFREBAFREBABQEREAQEVEAAAVEQEAVEQEAFAREQBARUQAABURAQBURAQAUBERAEBFRAAAFREBAFREBABQEREAQEVEAAAVEQEAVEQEAFAREQBARUQAABURAQBURAQAUBERAEBFRAAAFREBAFREBABQEREAQEVEAAAVEQEAVEQEAFAREQBARUQAABURAQBURAQAUJm11jP+oY8/+Ipn/kM5a53zontn6wedOXvm8K7OdPvf1d1Zyxw+TObw4XuKOexOBABQEREAQEVEAAAVEQEAVEQEAFAREQBARUQAABURAQBURAQAUBERAEBFRAAAFREBAFREBABQEREAQEVEAAAVEQEAVEQEAFAREQBARUQAABURAQBURAQAUBERAEBFRAAAFREBAFREBABQEREAQEVEAAAVEQEAVEQEAFA59zA+9JqLjh/Gxz4r3Xzqrp0c92z6M77l8e0fc7Z/SP6PrR0c0xzmmfRUc9idCACgIiIAgIqIAAAqIgIAqIgIAKAiIgCAiogAACoiAgCoiAgAoCIiAICKiAAAKiICAKiICACgIiIAgIqIAAAqIgIAqIgIAKAiIgCAiogAACoiAgCoiAgAoCIiAICKiAAAKiICAKiICACgIiIAgIqIAAAqIgIAqIgIAKAiIgCAiogAACoiAgCoiAgAoCIiAICKiAAAKiICAKiICACgIiIAgIqIAAAqIgIAqIgIAKAiIgCAiogAACoiAgCoiAgAoCIiAICKiAAAKiICAKiICACgIiIAgIqIAAAqIgIAqIgIAKAiIgCAiogAACoiAgCoiAgAoCIiAIDKrLV2PQYA4AhyJwIAqIgIAKAiIgCAiogAACoiAgCoiAgAoCIiAICKiAAAKiICAKiICACgIiIAgIqIAAAqIgIAqIgIAKAiIgCAiogAACoiAgCoiAgAoCIiAICKiAAAKiICAKiICACgIiIAgMp/ANNgJy/Zg8oPAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="<code>class</code> <code>ImageItem</code>" class="doc_header"><code>class</code> <code>ImageItem</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Export--" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ImageItem</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>An item that <code>show</code>s with <a href="/data.core.html#show_image"><code>show_image</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="<code>class</code> <code>TitledImageItem</code>" class="doc_header"><code>class</code> <code>TitledImageItem</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Export--" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TitledImageItem</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>An item that <code>show</code>s an (image,title) tuple with <a href="/data.core.html#show_titled_image"><code>show_titled_image</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="<code>class</code> <code>Categorize</code>" class="doc_header"><code>class</code> <code>Categorize</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Categorize--" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Categorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>train_attr</code></strong>=<em><code>'train'</code></em>, <strong><code>subset_idx</code></strong>=<em><code>None</code></em>, <strong><code>mask</code></strong>=<em><code>None</code></em>, <strong><code>is_tuple</code></strong>=<em><code>None</code></em>) :: <a href="/data.pipeline.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Reversible transform of category string to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="End-to-end-dataset-example-with-MNIST">End-to-end dataset example with MNIST<a class="anchor-link" href="#End-to-end-dataset-example-with-MNIST">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span><span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span><span class="n">valid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#709) [/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/9932.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/7189.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/8498.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/8888.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/9004.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/7692.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/7556.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/8762.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/9182.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/train/3/7666.png...],
 (#699) [/home/ubuntu/fastai_docs/dev/data/mnist_tiny/valid/3/7692.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/valid/3/7484.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/valid/3/9157.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/valid/3/8703.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/valid/3/9182.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/valid/3/7130.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/valid/3/9905.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/valid/3/8607.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/valid/3/925.png,/home/ubuntu/fastai_docs/dev/data/mnist_tiny/valid/3/7006.png...])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">timg</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> <span class="n">assoc</span><span class="o">=</span><span class="n">ImageItem</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">tfms</span> <span class="o">=</span> <span class="p">[[</span><span class="n">timg</span><span class="p">,</span><span class="n">array</span><span class="p">,</span><span class="n">tensor</span><span class="p">,</span><span class="n">partial</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)],</span>
        <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">(</span><span class="n">subset_idx</span><span class="o">=</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">])]]</span>
<span class="n">tfm</span> <span class="o">=</span> <span class="n">TfmOver</span><span class="o">.</span><span class="n">piped</span><span class="p">(</span><span class="n">tfms</span><span class="p">)</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="n">TfmdList</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">tfm</span><span class="p">)</span>
<span class="c1"># NB: `DataSource` is an easier way to handle this common case</span>
<span class="n">train_ds</span><span class="p">,</span><span class="n">valid_ds</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">subset</span><span class="p">,</span> <span class="n">splits</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">train_ds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">decode_at</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="n">yd</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span><span class="n">xd</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_ds</span><span class="o">.</span><span class="n">show_at</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAABlCAYAAAAms095AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvOIA7rQAABH1JREFUeJztmz1IZFcUx39n/Cg0iAimMcWKrogRg5126SJkC0HxWxCNSgQFsbW1CApiZFNsFhFJpakU1G1Cigh+pRE/YhBELFYRVDIQkVHvFuatutFEXee88Xl+MAxv3sw7Z378ue96vSPOOYzoEvK7gaeASVbAJCtgkhUwyQqYZAVMsgKBkywiP4nIWxH5S0T+FJFvfO8paH+MiMjnwIZz7lhEcoFfga+dc7/71VPgkuycW3HOHXuH/zyyfGwpeJIBROQHEfkb+AN4C0z62k/QhgsPEYkDioEvge+ccxG/eglkkgGcc6fOud+Az4Bv/ewlsJIvEY+NyQ+HiHwqIlUi8omIxInIV0A18IuvfQVpTBaRdOBn4AvOA7QFfO+c+9HXvoIkOVYJ1HARq5hkBUyyAiZZgXjlekG+y8pNJyzJCphkBUyyAiZZAZOsgElWwCQrYJIVMMkKxLTkcDhMOBymtLSU0tJSRORWj6amJhYWFlhYWPD7KwAxLjkoaC/a36rY0tISALW1tQCsrKwAkJSUBIDI9csEx8fn2y1OTk5ITk4GoLW1FYC+vr779nxbbO3CT7RX4W7F69evATg6OrpyXF9fD0BCQsK1n9va2gJgfHyc3t5eAAYHBwHIz88HoKGhITpN/weWZAVickxeXFwEYH5+HoC2trY7F5qbmwOguLgYgNTUVAC2t7cB3o/ZD4iNyX4Sk2NyXl4eAAUFBff6/NnZGTU1NVdea2lpAaKS4P/FkqxATCbZmw/flXA4DEBXVxebm5sAVFVVAdDZ2fkwzd0DS7ICMTm7uCuHh4cAVFdXA/DmzZv353Z3dwFIT0+PRunL2OzCTwKRZG8+XVRU9K9zXV1dADQ3NwOQk5MTjRbAkuwvgUiyx8jICHC+ijc1NQXA2toaAGlpaQDMzs4CkJ2d/dDlb0xyoCRf5uzsDICBgQEAenp6ADg4OACgv78fgI6OjocqacOFnwQ2yR8yPT0NXEzzQqHzfHk3zaysj/7tjiXZT55Mkj0mJ89/nPrixQsAcnNzAVhdXf3YS1uS/eTJJdmbdZSVlQEXyV5fXwfg2bNn9720JdlPnpzkUChEKBSioqKCiooKIpEIkUiEiYkJJiYmolMzKlc1rhCTi/YaZGRkAODdkzY2NqJWy5KswJNLsrdhxvu3lLflKzMzM2o1LckKPOokn56eArC8vHzlubKykvj467/a2NgYADs7OwA8f/4cgPb29qj1aUlW4FEneX9/H4DCwsIrrw8PDzM6OgpASkoKADMzMwC8fPnyynvr6uoAiIuLi1qflmQFHvXahde7t7W2u7sbgL29vffba72x2ZtVeMfeNq5Xr14BkJiY+LHt2NqFnzzqJH+It8llaGiI4eFh4GLGUV5eDkBjYyMAJSUlD13ekuwngUqyz1iS/cQkK2CSFTDJCphkBbTXLm68AwcZS7ICJlkBk6yASVbAJCtgkhUwyQqYZAVMsgImWQGTrIBJVsAkK2CSFTDJCphkBUyyAiZZAZOsgElWwCQrYJIVMMkKvANmhUS8mVNiSQAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="<code>class</code> <code>TfmdDL</code>" class="doc_header"><code>class</code> <code>TfmdDL</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#TfmdDL--" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TfmdDL</code>(<strong><code>dataset</code></strong>, <strong><code>tfms</code></strong>=<em><code>None</code></em>, <strong><code>bs</code></strong>=<em><code>16</code></em>, <strong><code>is_tuple</code></strong>=<em><code>True</code></em>, <strong><code>shuffle</code></strong>=<em><code>False</code></em>, <strong><code>sampler</code></strong>=<em><code>None</code></em>, <strong><code>batch_sampler</code></strong>=<em><code>None</code></em>, <strong><code>num_workers</code></strong>=<em><code>1</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/core.html#GetAttr"><code>GetAttr</code></a></p>
</blockquote>
<p>Transformed <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> using a <a href="/data.pipeline.html#Pipeline"><code>Pipeline</code></a> of <code>tfm</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfm</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">neg</span><span class="p">,</span><span class="n">decodes</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">neg</span><span class="p">)</span>
<span class="n">dummy_tfm</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="n">noop</span><span class="p">,</span><span class="n">assoc</span><span class="o">=</span><span class="n">Item</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">tl</span> <span class="o">=</span> <span class="n">TfmdList</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">dummy_tfm</span><span class="p">)</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">TfmdDL</span><span class="p">(</span><span class="n">tl</span><span class="p">,</span> <span class="n">tfm</span><span class="p">,</span> <span class="n">is_tuple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">tdl</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tdl</span><span class="p">),</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tl</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tdl</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Methods">Methods<a class="anchor-link" href="#Methods">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>TfmdDL.one_batch</code>" class="doc_header"><code>TfmdDL.one_batch</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#TfmdDL--" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TfmdDL.one_batch</code>()</p>
</blockquote>
<p>Grab first batch of <code>dl</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>TfmdDL.decode</code>" class="doc_header"><code>TfmdDL.decode</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#TfmdDL--" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TfmdDL.decode</code>(<strong><code>b</code></strong>)</p>
</blockquote>
<p>Decode <code>b</code> using <code>ds_tfm</code> and <code>tfm</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">tdl</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>TfmdDL.show_batch</code>" class="doc_header"><code>TfmdDL.show_batch</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#TfmdDL--" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>TfmdDL.show_batch</code>(<strong><code>b</code></strong>=<em><code>None</code></em>, <strong><code>max_rows</code></strong>=<em><code>1000</code></em>, <strong><code>ctxs</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Show each item of <code>b</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_stdout</span><span class="p">(</span><span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;(tensor(0),)</span>
<span class="s2">(tensor(1),)</span>
<span class="s2">(tensor(2),)</span>
<span class="s2">(tensor(3),)&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="<code>class</code> <code>Cuda</code>" class="doc_header"><code>class</code> <code>Cuda</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Cuda--" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Cuda</code>(<strong><code>device</code></strong>=<em><code>0</code></em>) :: <a href="/data.pipeline.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Move batch to <a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a> (defaults to <a href="/core.html#defaults.device"><code>defaults.device</code></a>)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfm</span> <span class="o">=</span> <span class="n">Cuda</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>Cuda.encodes</code>" class="doc_header"><code>Cuda.encodes</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Cuda--" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Cuda.encodes</code>(<strong><code>b</code></strong>)</p>
</blockquote>
<p>Move batch to <a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that, like all <a href="/data.pipeline.html#Transform"><code>Transform</code></a>s, <code>encodes</code> is called by <code>tfm()</code> and <code>decodes</code> is called by <code>tfm.decode()</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.cuda.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>Cuda.decodes</code>" class="doc_header"><code>Cuda.decodes</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Cuda--" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Cuda.decodes</code>(<strong><code>b</code></strong>)</p>
</blockquote>
<p>Return batch to CPU</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="<code>class</code> <code>ByteToFloatTensor</code>" class="doc_header"><code>class</code> <code>ByteToFloatTensor</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#ByteToFloatTensor--" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ByteToFloatTensor</code>(<strong><code>div</code></strong>=<em><code>True</code></em>, <strong><code>mask</code></strong>=<em><code>None</code></em>, <strong><code>is_tuple</code></strong>=<em><code>None</code></em>) :: <a href="/data.pipeline.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Transform image to float tensor, optionally dividing by 255 (e.g. for images).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tensor</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">tfm</span> <span class="o">=</span> <span class="n">ByteToFloatTensor</span><span class="p">(</span><span class="n">is_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ft</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">ft</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="<code>class</code> <code>Normalize</code>" class="doc_header"><code>class</code> <code>Normalize</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#Normalization--" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Normalize</code>(<strong><code>mean</code></strong>, <strong><code>std</code></strong>, <strong><code>mask</code></strong>=<em><code>None</code></em>, <strong><code>is_tuple</code></strong>=<em><code>None</code></em>) :: <a href="/data.pipeline.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Normalize/denorm batch</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">broadcast_vec</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">cuda</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="s2">&quot;Make a vector broadcastable over `dim` (out of `ndim` total) by prepending and appending unit axes&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">ndim</span>
    <span class="n">v</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">to_device</span> <span class="k">if</span> <span class="n">cuda</span> <span class="k">else</span> <span class="n">noop</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">*</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
<span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="n">broadcast_vec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
<span class="n">dl_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">Cuda</span><span class="p">(),</span> <span class="n">ByteToFloatTensor</span><span class="p">(),</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">)]</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">TfmdDL</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">dl_tfms</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span>  <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">decode</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
<span class="n">xd</span> <span class="o">=</span> <span class="n">xd</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.cuda.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">xd</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">&lt;</span><span class="mf">0.0</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">&gt;</span><span class="mf">0.5</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">&lt;</span><span class="mi">1</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">&lt;</span><span class="mf">0.5</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">ctxs</span><span class="o">=</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="<code>class</code> <code>DataBunch</code>" class="doc_header"><code>class</code> <code>DataBunch</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#DataBunch--" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DataBunch</code>(<strong>*<code>dls</code></strong>) :: <a href="/core.html#GetAttr"><code>GetAttr</code></a></p>
</blockquote>
<p>Basic wrapper around several <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a>s.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dbch</span> <span class="o">=</span> <span class="n">DataBunch</span><span class="p">(</span><span class="n">tdl</span><span class="p">,</span><span class="n">tdl</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span>  <span class="o">=</span> <span class="n">dbch</span><span class="o">.</span><span class="n">train_dl</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">tdl</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
<span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="n">dbch</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>DataBunch.__getitem__</code>" class="doc_header"><code>DataBunch.__getitem__</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/04_data_core.ipynb#DataBunch--" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>DataBunch.__getitem__</code>(<strong><code>i</code></strong>)</p>
</blockquote>
<p>Retrieve <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a> at <code>i</code> (<code>0</code> is training, <code>1</code> is validation)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span> <span class="o">=</span> <span class="n">dbch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>train_dl</code>" class="doc_header"><code>train_dl</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Training <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>valid_dl</code>" class="doc_header"><code>valid_dl</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Validation <a href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>train_ds</code>" class="doc_header"><code>train_ds</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Training <code>Dataset</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="<code>valid_ds</code>" class="doc_header"><code>valid_ds</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Validation <code>Dataset</code></p>

</div>

</div>

</div>
</div>

</div>
</div>
 


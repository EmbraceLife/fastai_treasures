---

title: Converting notebooks to modules
keywords: fastai
sidebar: home_sidebar

summary: "The functions that transform the dev notebooks in the fastai library"
---
<!--


#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: dev/91_notebook_export.ipynb
# instructions: https://docs.fast.ai/gen_doc_main.html

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reading-a-notebook">Reading a notebook<a class="anchor-link" href="#Reading-a-notebook">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What's-a-notebook?">What's a notebook?<a class="anchor-link" href="#What's-a-notebook?">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A jupyter notebook is a json file behind the scenes. We can just read it with the json module, which will return a nested dictionary of dictionaries/lists of dictionaries, but there are some small differences between reading the json and using the tools from <code>nbformat</code> so we'll use this one.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_nb" class="doc_header"><code>read_nb</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/91_notebook_export.ipynb#What's-a-notebook?" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_nb</code>(<strong><code>fname</code></strong>)</p>
</blockquote>
<p>Read the notebook in <code>fname</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>fname</code> can be a string or a pathlib object.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_nb</span> <span class="o">=</span> <span class="n">read_nb</span><span class="p">(</span><span class="s1">&#39;91_notebook_export.ipynb&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The root has four keys: <code>cells</code> contains the cells of the notebook, <code>metadata</code> some stuff around the version of python used to execute the notebook, <code>nbformat</code> and <code>nbformat_minor</code> the version of nbformat.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_nb</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;cells&#39;, &#39;metadata&#39;, &#39;nbformat&#39;, &#39;nbformat_minor&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_nb</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;kernelspec&#39;: {&#39;display_name&#39;: &#39;Python 3&#39;,
  &#39;language&#39;: &#39;python&#39;,
  &#39;name&#39;: &#39;python3&#39;},
 &#39;language_info&#39;: {&#39;codemirror_mode&#39;: {&#39;name&#39;: &#39;ipython&#39;, &#39;version&#39;: 3},
  &#39;file_extension&#39;: &#39;.py&#39;,
  &#39;mimetype&#39;: &#39;text/x-python&#39;,
  &#39;name&#39;: &#39;python&#39;,
  &#39;nbconvert_exporter&#39;: &#39;python&#39;,
  &#39;pygments_lexer&#39;: &#39;ipython3&#39;,
  &#39;version&#39;: &#39;3.7.1&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{test_nb[&#39;nbformat&#39;]}</span><span class="s2">.</span><span class="si">{test_nb[&#39;nbformat_minor&#39;]}</span><span class="s2">&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;4.2&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The cells key then contains a list of cells. Each one is a new dictionary that contains entries like the type (code or markdown), the source (what is written in the cell) and the output (for code cells).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_nb</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;cell_type&#39;: &#39;code&#39;,
 &#39;execution_count&#39;: 1,
 &#39;metadata&#39;: {&#39;hide_input&#39;: False},
 &#39;outputs&#39;: [],
 &#39;source&#39;: &#39;# export\nfrom local.imports import *\nfrom local.notebook.core import *\nimport nbformat,inspect&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Finding-patterns">Finding patterns<a class="anchor-link" href="#Finding-patterns">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_re" class="doc_header"><code>check_re</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/91_notebook_export.ipynb#Finding-patterns" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_re</code>(<strong><code>cell</code></strong>, <strong><code>pat</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cell</span> <span class="o">=</span> <span class="n">test_nb</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">check_re</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s1">&#39;# export&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="k">assert</span> <span class="n">check_re</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s1">&#39;# bla&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_export" class="doc_header"><code>is_export</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/91_notebook_export.ipynb#Finding-patterns" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_export</code>(<strong><code>cell</code></strong>, <strong><code>default</code></strong>)</p>
</blockquote>
<p>Check if <code>cell</code> is to be exported and returns the name of the module.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The cells to export are marked with an <code>#export</code> or <code>#exports</code> code, potentially with a module name where we want it exported. The default is given in a cell of the form <code>#default_exp bla</code> inside the notebook (usually at the top), though in this function, it needs the be passed (the final script will read the whole notebook to find it).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cell</span> <span class="o">=</span> <span class="n">test_nb</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">is_export</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;export&#39;</span>
<span class="n">cell</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;# exports&quot;</span> 
<span class="k">assert</span> <span class="n">is_export</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;export&#39;</span>
<span class="n">cell</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;# export mod&quot;</span> 
<span class="k">assert</span> <span class="n">is_export</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;mod&#39;</span>
<span class="n">cell</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;# export mod.file&quot;</span> 
<span class="k">assert</span> <span class="n">is_export</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;mod/file&#39;</span>
<span class="n">cell</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;# expt mod.file&quot;</span>
<span class="k">assert</span> <span class="n">is_export</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="find_default_export" class="doc_header"><code>find_default_export</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/91_notebook_export.ipynb#Finding-patterns" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>find_default_export</code>(<strong><code>cells</code></strong>)</p>
</blockquote>
<p>Find in <code>cells</code> the default export module.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Stops at the first cell containing a <code>#default_exp</code> code and return the value behind. Returns <code>None</code> if there are no cell with that code.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">find_default_export</span><span class="p">(</span><span class="n">test_nb</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;notebook.export&#39;</span>
<span class="k">assert</span> <span class="n">find_default_export</span><span class="p">(</span><span class="n">test_nb</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">:])</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exporting-notebooks">Exporting notebooks<a class="anchor-link" href="#Exporting-notebooks">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're now ready to export notebooks!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="export_names" class="doc_header"><code>export_names</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/91_notebook_export.ipynb#Exporting-notebooks" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>export_names</code>(<strong><code>code</code></strong>, <strong><code>func_only</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Find the names of the objects, functions or classes defined in <code>code</code> that are exported.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This function only picks the zero-indented objects, functions or classes (we don't want the class methods for instance) and excludes private names (that begin with <code>_</code>). It only returns func and class names when <code>func_only=True</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">export_names</span><span class="p">(</span><span class="s2">&quot;def my_func(x)():</span><span class="se">\n</span><span class="s2">  pass</span><span class="se">\n</span><span class="s2">class MyClass():&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;my_func&quot;</span><span class="p">,</span> <span class="s2">&quot;MyClass&quot;</span><span class="p">]</span>
<span class="c1">#Indented funcs are ignored (funcs inside a class)</span>
<span class="k">assert</span> <span class="n">export_names</span><span class="p">(</span><span class="s2">&quot;  def my_func(x)():</span><span class="se">\n</span><span class="s2">  pass</span><span class="se">\n</span><span class="s2">class MyClass():&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;MyClass&quot;</span><span class="p">]</span>
<span class="c1">#Private funcs are ignored</span>
<span class="k">assert</span> <span class="n">export_names</span><span class="p">(</span><span class="s2">&quot;def _my_func():</span><span class="se">\n</span><span class="s2">  pass</span><span class="se">\n</span><span class="s2">class MyClass():&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;MyClass&quot;</span><span class="p">]</span>
<span class="c1">#trailing spaces</span>
<span class="k">assert</span> <span class="n">export_names</span><span class="p">(</span><span class="s2">&quot;def my_func ():</span><span class="se">\n</span><span class="s2">  pass</span><span class="se">\n</span><span class="s2">class MyClass():&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;my_func&quot;</span><span class="p">,</span> <span class="s2">&quot;MyClass&quot;</span><span class="p">]</span>
<span class="c1">#class without parenthesis</span>
<span class="k">assert</span> <span class="n">export_names</span><span class="p">(</span><span class="s2">&quot;def my_func ():</span><span class="se">\n</span><span class="s2">  pass</span><span class="se">\n</span><span class="s2">class MyClass:&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;my_func&quot;</span><span class="p">,</span> <span class="s2">&quot;MyClass&quot;</span><span class="p">]</span>
<span class="c1">#object and funcs</span>
<span class="k">assert</span> <span class="n">export_names</span><span class="p">(</span><span class="s2">&quot;def my_func ():</span><span class="se">\n</span><span class="s2">  pass</span><span class="se">\n</span><span class="s2">default_bla = []:&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;my_func&quot;</span><span class="p">,</span> <span class="s2">&quot;default_bla&quot;</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">export_names</span><span class="p">(</span><span class="s2">&quot;def my_func ():</span><span class="se">\n</span><span class="s2">  pass</span><span class="se">\n</span><span class="s2">default_bla = []:&quot;</span><span class="p">,</span> <span class="n">func_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;my_func&quot;</span><span class="p">]</span>
<span class="c1">#Private objects are ignored</span>
<span class="k">assert</span> <span class="n">export_names</span><span class="p">(</span><span class="s2">&quot;def my_func ():</span><span class="se">\n</span><span class="s2">  pass</span><span class="se">\n</span><span class="s2">_default_bla = []:&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;my_func&quot;</span><span class="p">]</span>
<span class="c1">#Objects with dots are privates if one part is private</span>
<span class="k">assert</span> <span class="n">export_names</span><span class="p">(</span><span class="s2">&quot;def my_func ():</span><span class="se">\n</span><span class="s2">  pass</span><span class="se">\n</span><span class="s2">default.bla = []:&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;my_func&quot;</span><span class="p">,</span> <span class="s2">&quot;default.bla&quot;</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">export_names</span><span class="p">(</span><span class="s2">&quot;def my_func ():</span><span class="se">\n</span><span class="s2">  pass</span><span class="se">\n</span><span class="s2">default._bla = []:&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;my_func&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="extra_add" class="doc_header"><code>extra_add</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/91_notebook_export.ipynb#Exporting-notebooks" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>extra_add</code>(<strong><code>code</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">extra_add</span><span class="p">(</span><span class="s1">&#39;_all_ = [&quot;func&quot;, &quot;func1&quot;, &quot;func2&quot;]&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">([</span><span class="s2">&quot;&#39;func&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;func1&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;func2&#39;&quot;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">extra_add</span><span class="p">(</span><span class="s1">&#39;_all_ = [&quot;func&quot;,   &quot;func1&quot; , &quot;func2&quot;]&#39;</span><span class="p">)</span> <span class="o">==</span>  <span class="p">([</span><span class="s2">&quot;&#39;func&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;func1&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;func2&#39;&quot;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">extra_add</span><span class="p">(</span><span class="s2">&quot;_all_ = [&#39;func&#39;,&#39;func1&#39;, &#39;func2&#39;]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">==</span>  <span class="p">([</span><span class="s2">&quot;&#39;func&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;func1&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;func2&#39;&quot;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">extra_add</span><span class="p">(</span><span class="s1">&#39;code</span><span class="se">\n\n</span><span class="s1">_all_ = [&quot;func&quot;, &quot;func1&quot;, &quot;func2&quot;]&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="p">([</span><span class="s2">&quot;&#39;func&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;func1&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;func2&#39;&quot;</span><span class="p">],</span><span class="s1">&#39;code&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;test_add.txt&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Bla</span><span class="se">\n</span><span class="s2">__all__ = [my_file, MyClas]</span><span class="se">\n</span><span class="s2">Bli&quot;</span><span class="p">)</span>
<span class="n">_add2add</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;new_function&#39;</span><span class="p">])</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> 
    <span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Bla</span><span class="se">\n</span><span class="s2">__all__ = [my_file, MyClas, new_function]</span><span class="se">\n</span><span class="s2">Bli&quot;</span>
<span class="n">_add2add</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;new_function</span><span class="si">{i}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> 
    <span class="k">assert</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;&quot;Bla</span>
<span class="s2">__all__ = [my_file, MyClas, new_function, new_function0, new_function1, new_function2, new_function3, new_function4,</span>
<span class="s2">           new_function5, new_function6, new_function7, new_function8, new_function9]</span>
<span class="s2">Bli&quot;&quot;&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">_relative_import</span><span class="p">(</span><span class="s1">&#39;local.core&#39;</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;local&#39;</span><span class="p">)</span><span class="o">/</span><span class="s1">&#39;data.py&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;.core&#39;</span>
<span class="k">assert</span> <span class="n">_relative_import</span><span class="p">(</span><span class="s1">&#39;local.core&#39;</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;local&#39;</span><span class="p">)</span><span class="o">/</span><span class="s1">&#39;vision&#39;</span><span class="o">/</span><span class="s1">&#39;data.py&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;..core&#39;</span>
<span class="k">assert</span> <span class="n">_relative_import</span><span class="p">(</span><span class="s1">&#39;local.vision.transform&#39;</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;local&#39;</span><span class="p">)</span><span class="o">/</span><span class="s1">&#39;vision&#39;</span><span class="o">/</span><span class="s1">&#39;data.py&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;.transform&#39;</span>
<span class="k">assert</span> <span class="n">_relative_import</span><span class="p">(</span><span class="s1">&#39;local.notebook.core&#39;</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;local&#39;</span><span class="p">)</span><span class="o">/</span><span class="s1">&#39;data&#39;</span><span class="o">/</span><span class="s1">&#39;external.py&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;..notebook.core&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_notebook2script</span><span class="p">(</span><span class="s1">&#39;92_notebook_showdoc.ipynb&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 92_notebook_showdoc.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="notebook2script" class="doc_header"><code>notebook2script</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/91_notebook_export.ipynb#Exporting-notebooks" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>notebook2script</code>(<strong><code>fname</code></strong>=<em><code>None</code></em>, <strong><code>all_fs</code></strong>=<em><code>None</code></em>, <strong><code>up_to</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Convert <code>fname</code> or all the notebook satisfying <code>all_fs</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finds cells starting with <code>#export</code> and puts them into the appropriate module.</p>
<ul>
<li><code>fname</code>: the filename of one notebook to convert</li>
<li><code>all_fs</code>: <code>True</code> if you want to convert all notebook files in the folder or a glob expression</li>
<li><code>up_to</code>: converts all notebooks respecting the previous arg up to a certain number</li>
</ul>
<p>Examples of use in console:</p>

<pre><code>notebook2script                                 # Parse all files
notebook2script --fname 00_export.ipynb         # Parse 00_export.ipynb
notebook2script --all_fs=nb*                    # Parse all files starting with nb*
notebook2script --up_to=10                      # Parse all files with (name&lt;='10')
notebook2script --all_fs=*_*.ipynb --up_to=10   # Parse all files with an '_' and (name&lt;='10')</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Finding-the-way-back-to-notebooks">Finding the way back to notebooks<a class="anchor-link" href="#Finding-the-way-back-to-notebooks">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_name" class="doc_header"><code>get_name</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/91_notebook_export.ipynb#Finding-the-way-back-to-notebooks" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_name</code>(<strong><code>obj</code></strong>)</p>
</blockquote>
<p>Get the name of <code>obj</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">local.data.pipeline</span> <span class="k">import</span> <span class="o">*</span>
<span class="k">assert</span> <span class="n">get_name</span><span class="p">(</span><span class="n">Pipeline</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Pipeline&#39;</span>
<span class="k">assert</span> <span class="n">get_name</span><span class="p">(</span><span class="n">Pipeline</span><span class="o">.</span><span class="n">composed</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;composed&#39;</span>
<span class="k">assert</span> <span class="n">get_name</span><span class="p">(</span><span class="n">Union</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;Union&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="qual_name" class="doc_header"><code>qual_name</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/91_notebook_export.ipynb#Finding-the-way-back-to-notebooks" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>qual_name</code>(<strong><code>obj</code></strong>)</p>
</blockquote>
<p>Get the qualified name of <code>obj</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">qual_name</span><span class="p">(</span><span class="n">Pipeline</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Pipeline&#39;</span>
<span class="k">assert</span> <span class="n">qual_name</span><span class="p">(</span><span class="n">Pipeline</span><span class="o">.</span><span class="n">composed</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Pipeline.composed&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="source_nb" class="doc_header"><code>source_nb</code><a href="https://nbviewer.jupyter.org/github/fastai/fastai_docs/blob/master/dev/91_notebook_export.ipynb#Finding-the-way-back-to-notebooks" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>source_nb</code>(<strong><code>func</code></strong>, <strong><code>is_name</code></strong>=<em><code>None</code></em>, <strong><code>return_all</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Return the name of the notebook where <code>func</code> was defined</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can either pass an object or its name (by default <code>is_name</code> will look if <code>func</code> is a string or not, but you can override if there is some inconsistent behavior).</p>
<p>If passed a method of a class, the function will return the notebook in which the largest part of the function was defined in case there is a monkey-matching that defines <code>class.method</code> in a different notebook than <code>class</code>. If <code>return_all=True</code>, the function will return a tuple with the name by which the function was found and the notebook.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">local.data.pipeline</span> <span class="k">import</span> <span class="n">Transform</span>
<span class="kn">from</span> <span class="nn">local.test</span> <span class="k">import</span> <span class="n">test_fail</span>
<span class="kn">from</span> <span class="nn">local.core</span> <span class="k">import</span> <span class="n">opt_call</span>

<span class="k">assert</span> <span class="n">source_nb</span><span class="p">(</span><span class="n">test_fail</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;00_test.ipynb&#39;</span>
<span class="k">assert</span> <span class="n">source_nb</span><span class="p">(</span><span class="n">Transform</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;02_data_pipeline.ipynb&#39;</span>
<span class="k">assert</span> <span class="n">source_nb</span><span class="p">(</span><span class="n">Transform</span><span class="o">.</span><span class="n">create</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;02_data_pipeline.ipynb&#39;</span>
<span class="c1">#opt_call is in the core module but defined in 02</span>
<span class="k">assert</span> <span class="n">source_nb</span><span class="p">(</span><span class="n">opt_call</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;02_data_pipeline.ipynb&#39;</span>
<span class="k">assert</span> <span class="n">source_nb</span><span class="p">(</span><span class="n">Tensor</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="c1">#Add a test of class.func when it&#39;s added through a monkey-patch</span>

<span class="c1">#Test with name</span>
<span class="k">assert</span> <span class="n">source_nb</span><span class="p">(</span><span class="s1">&#39;Pipeline&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;02_data_pipeline.ipynb&#39;</span>
<span class="k">assert</span> <span class="n">source_nb</span><span class="p">(</span><span class="s1">&#39;Pipeline.decode&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;02_data_pipeline.ipynb&#39;</span>

<span class="c1">#Test return_all</span>
<span class="k">assert</span> <span class="n">source_nb</span><span class="p">(</span><span class="n">Pipeline</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;Pipeline&#39;</span><span class="p">,</span><span class="s1">&#39;02_data_pipeline.ipynb&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">source_nb</span><span class="p">(</span><span class="n">Pipeline</span><span class="o">.</span><span class="n">decode</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="s1">&#39;Pipeline&#39;</span><span class="p">,</span><span class="s1">&#39;02_data_pipeline.ipynb&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

